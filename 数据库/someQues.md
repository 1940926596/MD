# 数据库

## 概念

### 1. **E-R 模型（Entity-Relationship Model，实体-联系模型）**

- **是谁提出的？** 1976 年由陈品山（Peter Chen）提出。
- **用途：**
   一种 **概念模型**，用于在逻辑建库之前，用图形方式直观地表示现实世界中的数据结构。
- **核心元素：**
  1. **实体（Entity）**
     - 现实世界中可区分的事物（人、物、事件）。
     - 在图中用 **矩形** 表示。
     - 例如：学生、课程。
  2. **属性（Attribute）**
     - 实体或联系的特征。
     - 在图中用 **椭圆** 表示。
     - 例如：学号、姓名、课程号。
  3. **联系（Relationship）**
     - 实体之间的相互关系。
     - 在图中用 **菱形** 表示。
     - 例如：学生 **选修** 课程。
  4. **联系的基数（Cardinality）**
     - 一对一 (1:1)，一对多 (1:N)，多对多 (M:N)。

### 2. 关系模型（Relational Model）

- **是谁提出的？** 1970 年由 Edgar F. Codd 提出。

- **用途：**
   一种 **逻辑模型**，也是现代关系型数据库（MySQL、Oracle、PostgreSQL 等）的理论基础。

- **核心元素：**

  1. **关系（Relation）**
     - 可以理解为一张 **二维表**。
     - 表名就是关系名。
  2. **元组（Tuple）**
     - 表中的一行数据。
     - 例如学生表中的一条记录。
  3. **属性（Attribute）**
     - 表中的一列，对应字段名。
     - 例如学号、姓名。
  4. **码（Key）**
     - 用来唯一标识元组的属性或属性组合。
     - 例如学号是学生表的主码。
  5. **关系之间的联系**
     - 通过 **外键（Foreign Key）** 来实现。

   简单说：关系模型是“表格化的数据库结构”，它属于 **逻辑实现层面**，是数据库实现的基础

  ### 3. 非关系模型（Non-Relational Model）

  **非关系模型**（Non-Relational Model），其实就是 **不基于关系模型（表格）的数据库模型**。它是相对于关系型数据库（RDBMS）的概念，常用在大数据和高并发场景。下面我给你系统解释：

  ------

  #### 1. **定义**

  - **非关系模型**是一类 **不使用二维表（关系表）存储数据** 的数据库模型。
  - 数据存储方式可以更灵活（文档、键值、图、列族等），不需要严格的模式（Schema），或者模式可以动态变化。

  ------

  #### 2. **非关系数据库分类**

  常见分类有 4 种主要类型：

  | 类型                       | 说明                                                         | 示例                  |
  | -------------------------- | ------------------------------------------------------------ | --------------------- |
  | **键-值型 (Key-Value)**    | 数据以键值对存储，适合快速查找和缓存                         | Redis, DynamoDB, Riak |
  | **文档型 (Document)**      | 数据以 JSON、BSON 或 XML 文档存储，每条记录是一个文档，结构可变 | MongoDB, CouchDB      |
  | **列族型 (Column-Family)** | 按列而不是按行存储，适合大数据分析                           | HBase, Cassandra      |
  | **图型 (Graph)**           | 专门存储节点和边，适合处理复杂关系                           | Neo4j, JanusGraph     |

  ------

  #### 3. **特点**

  1. **灵活的结构**
     - 不需要固定表结构，新增字段不影响已有数据。
  2. **高扩展性**
     - 水平扩展（Sharding/分片）容易，适合海量数据。
  3. **高性能**
     - 对某些特定场景（如缓存、实时分析、社交网络）性能比关系型好。
  4. **弱化事务**
     - 不像关系型数据库有严格 ACID，通常强调 BASE（基本可用、软状态、最终一致性）。

  ------

  #### 4. **与关系模型对比**

  | 特性     | 关系模型               | 非关系模型                       |
  | -------- | ---------------------- | -------------------------------- |
  | 数据结构 | 表（二维关系）         | 键值、文档、列、图               |
  | 模式     | 固定（Schema）         | 可变 / 动态                      |
  | 事务支持 | 强 ACID                | 弱 BASE                          |
  | 扩展性   | 垂直扩展（加大服务器） | 水平扩展（分片）                 |
  | 典型用途 | 传统业务系统           | 大数据、实时分析、缓存、社交网络 |

  ------

  简单理解：

  - **关系模型** = 严格的表格，结构固定，事务强。
  - **非关系模型** = 灵活的存储形式，适合海量和多样化数据。

## 问题：

### 1. 字段（Field）与属性（Attribute）

- **属性 (Attribute)**：
   在 **E-R 模型** 或者 **关系模型**里使用的概念，指某个实体/关系的某种特性。
   例如：学生（实体）有属性 *学号*、*姓名*、*年龄*。
- **字段 (Field)**：
   在 **表（Table）** 里面的概念，对应于属性，是实际数据库表中的一列。
   可以认为 **属性是概念模型里的说法，字段是物理表里的说法**。

------

### 2. 元组（Tuple）与记录（Record）

- **元组 (Tuple)**：
   关系模型中的术语，指一行数据。
   例如：`(2021001, 张三, 20)` 就是一个元组。
- **记录 (Record)**：
   数据库实现层面上的说法，也表示一行数据。
   类似于 **元组是理论概念，记录是实际存储概念**。

------

### 3. 连接与笛卡尔积

- **笛卡尔积**：
   两个关系 `R` 和 `S` 的笛卡尔积是把 `R` 的每一行和 `S` 的每一行都组合起来。
   如果 `R` 有 m 行，`S` 有 n 行，笛卡尔积就有 m×n 行。
- **连接 (Join)**：
   在笛卡尔积的基础上加上 **条件筛选**。
   常见连接：
  - 等值连接（属性相等时连接）
  - 自然连接（等值连接去掉重复属性列）
  - 外连接（保留不匹配的数据，填 NULL）

------

### 4. 一对多关系

题目描述的是 **E-R 模型里的联系**：

> 若实体型 E₁, E₂,…, Eₙ 之间存在联系，对于实体型 **Eⱼ (j ≠ i)** 中的给定实体，最多只和 Eᵢ 中的一个实体相联系，则说 Eᵢ 与其他实体的关系是一对多的。

解释：

- 如果 **Eⱼ 的一个实体** 只能对应 **Eᵢ 的一个实体**，
- 但 **Eᵢ 的一个实体** 可以对应 **多个 Eⱼ 的实体**，
   👉 那么 Eᵢ 和 Eⱼ 就是一对多（Eᵢ 在“一”端，Eⱼ 在“多”端）。

举例：

- **班级 (Eᵢ)** 和 **学生 (Eⱼ)**：
  - 一个学生只能属于一个班级
  - 一个班级可以有多个学生
     → 班级和学生的关系是 **一对多**。

------

### 5. 视图（View）与模式（Schema）

- **模式 (Schema)**：
   数据库中数据的逻辑结构和组织方式的定义。
   它规定了有哪些表、字段、关系、约束。
   可以看作是 **数据库的框架/设计图**。

- **视图 (View)**：
   从一个或多个表（或视图）导出的虚拟表，本身不存储数据，只保存 SQL 定义。

  - 好处：安全性（隐藏敏感字段）、简化查询、逻辑独立性。

  - 例如：

    ```sql
    CREATE VIEW student_info AS
    SELECT 学号, 姓名 FROM 学生;
    ```

    → 这个视图对用户只暴露部分字段。

------

📌 总结类比：

- **属性 ↔ 字段**
- **元组 ↔ 记录**
- **笛卡尔积 = 所有组合**，**连接 = 笛卡尔积 + 条件**
- **一对多 = “一” 端唯一，“多” 端可重复**
- **模式 = 数据库框架，视图 = 派生虚拟表**
